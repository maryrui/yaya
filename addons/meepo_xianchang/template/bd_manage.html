{template 'common/header'}
<div class="row">
    <div class="col-md-2">{template 'nav'}</div>
    <div class="col-md-10">
        <form action="" method="post" class="form-horizontal" role="form">
            <input type="hidden" value="{$bd_manage['id']}"  name="bd_manage_id">
            <div class="panel panel-default">
                <div class="panel-heading">表单设置<br><br>
                    <font color=red>1 由于手机号码为必须录入项、故其他表单项目、值一定不能是mobile、且必须是拼音或是英文单词</font>
                    <font color=red>2 自定义表单活动开始后请不要去修改、新增或是删除表单项</font>
                </div>
                <div class="panel-body">
                    <div class="tab-content">
                        <div class="tab-pane  active" id="tab_basic">
                            <div class="panel panel-default">
                                <div class="panel-heading"></div>
                                <div class="panel-body">
                                    <div class="form-group">
                                        <label class="col-xs-12 col-sm-3 col-md-2  control-label">是否开启表单录入</label>
                                        <div class="col-sm-9 ">
                                            <label class="radio-inline">
                                                <input type="radio" name="show" value="0" id="show" {if $bd_manage['show'] == '0'}checked="true"{/if}> 关闭
                                            </label>
                                            <label class="radio-inline">
                                                <input type="radio" name="show" value="1" id="show"  {if $bd_manage['show'] == '1'}checked="true"{/if}>开启
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-xs-12 col-sm-3 col-md-2 control-label">表单项</label>
                                        <div class="col-xs-12 col-sm-9">
                                            <div class="panel panel-default live_advs">
                                                <div class="panel-body">
                                                    <ul class="list-group" id="vote_lists">
                                                        {if empty($bd_manage['xm'])}

                                                        <li class="list-group-item ng-scope" id="bd_box_{$key}">
                                                            <div class="form-group">

                                                                <div class="col-sm-9 col-xs-12  col-md-2">
                                                                    <input type="text" id='tagname' name="bd_displayid[]" class="form-control" value="1" placeholder="排序"/>

                                                                </div>
                                                                <label class="col-xs-12 col-sm-3 col-md-1 control-label">名称</label>
                                                                <div class="col-sm-9 col-xs-12  col-md-2">
                                                                    <input type="text" id='tagname' name="bd_name[]" class="form-control" value="手机号码" placeholder="名称"/ readonly>
                                                                </div>
                                                                <label class="col-xs-12 col-sm-3 col-md-1 control-label">值</label>
                                                                <div class="col-sm-9 col-xs-12  col-md-2 ">
                                                                    <input type="text" id='tagname' name="zd_name[]" class="form-control" value="mobile" placeholder="名称"/ readonly>
                                                                </div>
                                                                <div class="col-sm-9 col-xs-12 col-md-2 checkbox radio-inline">
                                                                    <input type="hidden" name="zd_show[]" value="{$row['zd_show']}" class="zd_tshow">
                                                                    <input type="checkbox"  {if $row['zd_show']=='1'}checked{/if}  class="change_show">显示
                                                                </div>
                                                            </div>
                                                        </li>
                                                        {/if}
                                                        {loop $bd_manage['xm'] $key $row}

                                                        <li class="list-group-item ng-scope" id="bd_box_{$key}">
                                                            <div class="form-group">

                                                                <div class="col-sm-9 col-xs-12  col-md-2">
                                                                    <input type="text" id='tagname' name="bd_displayid[]" class="form-control" value="{$row['displayid']}" placeholder="排序"/>

                                                                </div>
                                                                <label class="col-xs-12 col-sm-3 col-md-1 control-label">名称</label>
                                                                <div class="col-sm-9 col-xs-12  col-md-2">
                                                                    <input type="text" id='tagname' name="bd_name[]" class="form-control" value="{$row['bd_name']}" placeholder="名称"/ {if $row['zd_name']=='mobile'}readonly{/if}>
                                                                </div>
                                                                <label class="col-xs-12 col-sm-3 col-md-1 control-label">值</label>
                                                                <div class="col-sm-9 col-xs-12  col-md-2">
                                                                    <input type="text" id='tagname' name="zd_name[]" class="form-control" value="{$row['zd_name']}" readonly>
                                                                </div>
                                                                <div class="col-sm-9 col-xs-12 col-md-2 checkbox radio-inline">
                                                                    <input type="hidden" name="zd_show[]" value="{$row['zd_show']}" class="zd_tshow">
                                                                    <input type="checkbox"  {if $row['zd_show']=='1'}checked{/if}  class="change_show">显示
                                                                </div>
                                                                {if $row['zd_name']!='mobile'}
                                                                <div class="col-sm-8  col-xs-12 col-md-1">
                                                                    <a href="javascript:;" class="btn btn-danger" onclick="bd_delete({$key})" >删除</a>
                                                                </div>
                                                                {/if}
                                                            </div>
                                                        </li>

                                                        {/loop}

                                                    </ul>
                                                </div>
                                                <div class="panel-footer">
                                                    <a href="javascript:;" class="btn btn-success bd_add">添加表单项</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!----->
                                </div>
                            </div>
                            <div class="form-group col-sm-12">
                                <input type="submit" name="submit" value="提交" class="btn btn-primary col-lg-1" />
                                <input type="hidden" name="token" value="{$_W['token']}" />
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </form>
        <div id="bd_html" style="display: none">
            <div class="col-sm-9 col-xs-12 col-md-2">
                <input type="text"  name="bd_displayid[]" class="form-control"/>
            </div>
            <label class="col-xs-12 col-sm-3 col-md-1 control-label">名称</label>
            <div class="col-sm-9 col-xs-12 col-md-2">
                <input type="text" name="bd_name[]" class="form-control"/>
            </div>
            <label class="col-xs-12 col-sm-3 col-md-1 control-label">值</label>
            <div class="col-sm-9 col-xs-12 col-md-2">
                <input type="text" name="zd_name[]" class="form-control" readonly />
            </div>
            <div class="col-sm-9 col-xs-12 col-md-2 checkbox radio-inline">
                <input type="hidden" name="zd_show[]" value="2" class="zd_tshow">
                <input type="checkbox"  class="change_show">显示
            </div>
        </div>
    </div>
</div>



<script type="text/javascript">
    $(function(){
        $('.bd_add').on('click', function(){
            var bd_add = new Date().getTime();
            var content = '<li class="list-group-item ng-scope" id="bd_box_'+bd_add+'"><div class="form-group">';
            content += $("#bd_html").html();
            content += '<div class="col-sm-8  col-xs-12 col-md-1">';
            content += '<a href="javascript:;" class="btn btn-danger" onclick="bd_delete('+bd_add+')" >删除</a>';
            content += '</div>';
            content += '</div>';
            content += '</li>';

            $('#vote_lists').append(content);
            var list_length = $('#vote_lists li').length;
            $('#vote_lists li:last-child input:first').val(list_length);
            var new_s = randomWord(false, 5).toLowerCase();
            $('#vote_lists li:last-child input:eq(2)').val('bd_'+new_s);

        });
        $("body").on('click','.change_show', function(){
            if($("#vote_lists input[type='checkbox']:checked").length>2){
                $(this).attr("checked",false);
                alert('最多选两项');
                return;
            }
            var show_value = $(this).prev().val();
            if(show_value==1){
                $(this).prev().val(2);
            }else{
                $(this).prev().val(1);
            }
        });
    })
    function bd_delete(id){
        if(id){
            $("#bd_box_"+id).remove();
        }else{
            alert('id不存在');
        }
    }
    function randomWord(randomFlag, min, max){
        var str = "",
            range = min,
            arr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];

        // 随机产生
        if(randomFlag){
            range = Math.round(Math.random() * (max-min)) + min;
        }
        for(var i=0; i<range; i++){
            pos = Math.round(Math.random() * (arr.length-1));
            str += arr[pos];
        }
        return str;
    }
</script>
{template 'common/footer'}
